<!-- title=変数の巻き上げ -->

# 変数の巻き上げ

下のコードを読み、挙動を想像してみよう。
```js
var arg = "global";
 
function sample() {
    console.log(arg);    //①
    var arg = "local";
    console.log(arg);    //②
}
 
sample();
```

①、②ではどのようなログが出力されると予想するだろうか。
おそらく、①ではglobal、②ではlocalが出力されるように直感では予想できるだろう。
実際に試し、挙動を確認してみよう。

おそらく、①はundefined, ②はlocalとなったはず。
(ちなみに、let構文で宣言した際の挙動も見てみよう。①でundefinedではなく明示的にエラーが出力される。)

この挙動は、上記のコードが以下のコードと同様の文脈を持つことにより起きる。

```js
var arg = "global";
 
function sample() {
    var arg;
    console.log(arg);    //①
    arg = "local";
    console.log(arg);    //②
}
 
sample();
```

つまり、JavaScriptにおいて、

**関数内で宣言されたローカル変数は、すべてその関数の先頭で宣言されたものとしてみなされる。**
(但し、宣言のみで、値の代入は行われない。)

よって、変数argは、sample関数定義の先頭で宣言されたと見なされ、①、②ともにローカル変数argを参照する形になってしまう。
この性質を、**巻き上げ**というので覚えておこう。


巻き上げに困らされないよう、**関数内のローカル変数は、関数の先頭で宣言する**癖をつけよう。
